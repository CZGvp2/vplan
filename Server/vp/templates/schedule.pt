<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="description" content="Vertretungsplan des CZG" />
    <meta name="keywords" lang="de" content="Vertretungsplan, Carl-Zeiss, Gymnasium, Jena" />
    <title>Vertretungsplan</title>
    <link rel="stylesheet" type="text/css" href="${request.static_path('vp:static/css/schedule.css')}" />
    <link rel="shortcut icon" href="${request.static_path('vp:static/img/favicon.png')}" />
    <script src="${request.static_path('vp:static/js/jquery.min.js')}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="${request.static_path('vp:static/js/schedule.js')}"></script>
    <?python
      def color(subject):
          """Gibt die Farbe des Faches zurück"""
          colors = { # alle Farben von Philip ausgewählt
            'Ma' : '#006496',
            'Ph' : '#3296C8',
            'Inf' : '#64C8FA',
            'Ch' : '#009632',
            'Bio' : '#00C800',
            'De' : '#B40000',
            'Ge' : '#FF9B0F',
            'Geo' : '#FF690F',
            'En' : '#96001E',
            'Frz' : '#78003C',
            'La' : '#78003C',
            'Ru' : '#78003C',
            'Et' : '#FFCD0F',
            'Ku' : '#A0008C',
            'Mu' : '#8C00A0'
          }
          return colors.get(subject, '#555555') # Wert falls nicht gefunden
    ?>
    <script>
      var currentSlide = 0;
    </script>
</head>
<body>
    <div id="wrapper">
        <div id="topbar">
            <a href="${request.route_path('home', _query='logout')}">Abmelden</a>
            <a href="${request.route_path('upload')}" tal:condition="from_upload">Zurück zum Bearbeiten</a>
            <div class="space"></div>
            <img src="${request.static_path('vp:static/img/menue_icon.png')}" onClick="toggleMenue(); console.log('Menue Button Clicked')" height="1em" width="1em"></img><!-- TODO: IMAGE -->
        </div>
        <div id="header">
                Vertretungsplan
        </div>
        <div class="slidebutton">
          <div id="leftslidebutton" class="singleslidebutton" onclick="toggleSlide('left')"><span class="day_title" id="left">Freitag</span></div>
          <div id="rightslidebutton" class="singleslidebutton" onClick="toggleSlide('right')"><span class="day_title" id="right">Donnerstag</span></div>
        </div>
        <div class="slide" tal:repeat="day days">
            <div class="slide_title">
                ${day.date['weekday']}
            </div>
            <table class="table">
                <tr class="event" tal:repeat="event day.events" data-targets="${ ' '.join(event.targets) # Python Code!!! }" >
                    <td class="entry" />
                    <td class="entry" tal:content="event.time" />
                    <td class="entry" style="background-color: white; padding: .1em;">
                      <span tal:content="event.new['subject']" style="background-color: ${color(event.new['subject'])}; color: white; display: block;"></span>
                    </td>
                    <td class="entry" tal:content="event.new['teacher']" />
                    <td class="entry" tal:content="event.new['room']" />
                    <td class="entry" tal:content="event.old['subject']" />
                    <td class="entry" tal:content="event.old['teacher']" />
                    <td class="entry" tal:content="event.info" />
                    <td class="entry" tal:content="event.targets" />
                </tr>
            </table>
        </div>
        <script>
          var showAll = false;
          if(typeof $ == 'undefined') console.log("$ Error");
          removeEntries = function(){
            c = 0;
            for(var i = 0; i < $(".event").length; i++) {
              var b = $(".event")[i];
              dSet = b.dataset['targets'].toLowerCase();
              console.log(">" + dSet + "<");
              if(!(dSet.contains("sci") || showAll)) { // cookie reading here
                console.log(b.remove()); // Ich bin SEHR verwirrt... manchmal haut das die Zeilen raus und manchmal nicht...
              } else {
                console.log("--- ENTRY FOUND ---");
                c++;
              }
            }
            console.log(c);
            if(!c) $(".table").innerHTML += "keine Vertretungen";
          }
          $(removeEntries);
        </script>-->
        <!---<footer id="footer">CZG 2016</footer>--->
    </div>
</body>
</html>
