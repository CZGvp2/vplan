function handleServerResponse(e){debug&&(global_debug_responseBuffer=JSON.stringify(e),console.log(debugTag+"Got AJAX response: "+global_debug_responseBuffer));var r=$("#uploadList").get(0);$("#uploadList").css("display","flex");for(var o=0;o<e.results.length;o++){var a=e.results[o].success,n=e.results[o].file,s="undefined"==typeof errorDict[e.results[o].errorCode]?e.results[o].errorCode:errorDict[e.results[o].errorCode],t=a?"Erfolgeich!":"Fehlgeschlagen: "+s,l=a?"inherit":"#AA0000",u=a?e.results[o].replaced?"upload_change.png":"upload_new.png":"upload_error.png",d='<div class="upload"><img class="ulImg" src=".'+statics+u+'"></img><span> '+n+'</span><span class="space"></span><span style="background-color:'+l+';">'+t+"</span></div>";r.children.length>6&&r.children[0].remove(),r.innerHTML+=d}}function upload(e){for(var r=new FormData($("form")[0]),o=0;o<e.length;o++)r.append("file",e[o]);return debug&&console.log(debugTag+"Posting data to "+path+"."),$.ajax({url:path,type:"POST",data:r,dataType:"json",processData:!1,contentType:!1,success:handleServerResponse,failure:function(){var e=JSON.parse('results:[{success: false, filename: "---", errorCode: "CONNECTION_ERROR"}]');handleServerResponse(e)}})}var debug=!0,debugTag="[DEBUG] ";setColor=function(){$("body").css("background-color","#3a7ab6")},resetColor=function(){$("body").css("background-color","#0e0e0e")},$(document).on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),$(document).on("dragenter",function(e){setColor(),e.preventDefault(),e.stopPropagation()}),$(document).on("dragleave",function(e){resetColor(),e.preventDefault(),e.stopPropagation()}),$(document).on("drop",function(e){resetColor(),debug&&console.log(debugTag+"dropEvent caught, pushing to server..."),e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length&&(e.preventDefault(),e.stopPropagation(),resetColor(),upload(e.originalEvent.dataTransfer.files))});var errorDict={ERR_PARSING_XML:"Keine XML-Datei",ERR_READING_XML:"XML-Strukturfehler",ERR_PARSING_DATE:"Datumsformat fehlerhaft",ERR_DECODING:"Keine Textdatei (kein UTF-8 Format)"},global_debug_responseBuffer;
